# Report Vulnerable Light App
---
## 0. Vulnerability classification scale

> ANSSI offers a classification scale for vulnerabilities based on the risk they present for the information system. This classification takes into account the impact of the vulnerability on the system and the difficulty of exploitation. Risk levels are defined as follows :

![Classification Scale](./Screenshots/classification%20scale/anssi-echelle-vulnerabilites.png)

1. Ease of Operation:
- ğŸŸ¢ **Easy**: Simple operation, without any special tools.
- ğŸŸ¡ **Moderate**: Exploitation requiring simple techniques and publicly available tools.
- ğŸŸ  **High**: Exploitation of public vulnerabilities requiring information systems security skills and the development of simple tools.
- ğŸ”´ **Difficult**: Exploitation of unpublished vulnerabilities requiring expertise in information systems security and the development of specific and targeted tools.

2. Impact :
- ğŸŸ¢ **Minor**: No direct consequence on the security of the audited information system.
- ğŸŸ¡ **Important**: Isolated consequences on specific points of the audited information system.
- ğŸŸ  **Major**: Restricted consequences on part of the audited information system.
- ğŸ”´ **Critical**: Widespread consequences across the entire audited information system.

3. Risk Levels:
- ğŸŸ¢ **Minor**: Low risk to the information system. May require correction.
- ğŸŸ¡ **Important**: Moderate risk on the information system.
    - Requires medium-term correction.
- ğŸŸ  **Major**: Major risk to the information system.
    - Requires short-term correction.
- ğŸ”´ **Critical**: Critical risk on the information system.
    - Requires immediate correction or requires immediate termination of service.

---
## 1. Vulnerability table

| Check or not | CWE | Description | Impact | Working | Risk level |
|:------------:|:---:|-------------|:------:|:-------:|:----------:|
| âœ… | CWE-~~22~~ 23 | Path Traversal | ğŸŸ Major | ğŸŸ¢Easy | ğŸ”´**CRITICAL** |
| âŒ | CWE-78 | OS Command Injection | / | / | / |
| âœ… | CWE-79 | Cross-site Scripting | ğŸŸ Major | ğŸŸ¢Easy | ğŸ”´**CRITICAL** |
| âœ… | CWE-89 | SQL Injection | ğŸŸ Major | ğŸŸ¢Easy | ğŸ”´**CRITICAL** |
| âŒ | CWE-94 | Code Injection | / | / | / |
| âŒ | CWE-91 | XML Injection | / | / | / |
| âŒ | CWE-98 | Remote File Inclusion | / | / | / |
| âŒ | CWE-184 | Incomplete List of Disallowed Inputs | / | / | / |
| âœ… | + CWE-200[^1] | Exposure of Sensitive Information to an Unauthorized Actor | ğŸŸ Major | ğŸŸ¢Easy | ğŸ”´**CRITICAL** |
| âŒ | CWE-213 | Exposure of Sensitive Information Due to Incompatible Policies | / | / | / |
| âœ… | CWE-284 | Improper Access Control | ğŸ”´Critical | ğŸŸ¡Moderate | ğŸ”´**CRITICAL** |
| âŒ | CWE-287 | Improper Authentication | / | / | / |
| âœ… | CWE-319 | Cleartext Transmission of Sensitive Information | ğŸŸ Major | ğŸŸ¡Moderate | ğŸŸ Major |
| âŒ | CWE-326 | Inadequate Encryption Strength | / | / | / |
| âŒ | CWE-434 | Unrestricted Upload of File with Dangerous Type | / | / | / |
| âŒ | CWE-502 | Deserialization of Untrusted Data | / | / | / |
| âŒ | CWE-521 | Weak Password Requirements | / | / | / |
| âŒ | CWE-532 | Insertion of Sensitive Information into Log File | / | / | / |
| âŒ | CWE 639 | Insecure Direct Object Reference | / | / | / |
| âŒ | CWE-611 | Improper Restriction of XML External Entity Reference | / | / | / |
| âŒ | CWE-787 | Out-of-bounds Write | / | / | / |
| âœ… | CWE-798 | Use of Hard-coded Credentials | ğŸŸ Major | ğŸŸ¡Important | ğŸŸ Major |
| âŒ | CWE-829 | Local file Inclusion | / | / | / |
| âŒ | CWE-918 | Server-Side Request Forgery (SSRF) | / | / | / |
| âŒ | CWE-1270 | Generation of Incorrect Security Tokens | / | / | / |
| âŒ | CWE-1395 | Dependency on Vulnerable Third-Party Component | / | / | / |

## 2. Screen of our tests

| CWE | Request | Response |
|:---:|:-------:|:--------:|
| CWE-23 | ![CWE-23-1-Request](./Screenshots/CWE-23/cwe-23-1-request.png) ![CWE-23-2-Request](./Screenshots/CWE-23/cwe-23-2-request.png) | ![CWE-23-1-Response](./Screenshots/CWE-23/cwe-23-1-response.png) ![CWE-23-2-Response](./Screenshots/CWE-23/cwe-23-2-response.png) |
| CWE-79 | ![CWE-23-1-Request](./Screenshots/CWE-79/cwe-79-request.png) | ![CWE-23-1-Response](./Screenshots/CWE-79/cwe-79-response.png) |
| CWE-89 | ![CWE-89-Request](./Screenshots/CWE-89/cwe-89-request.png) | ![CWE-89-Response](./Screenshots/CWE-89/cwe-89-response.png) |
| CWE-200 | ![CWE-200-Request](./Screenshots/CWE-200/cwe-200-request.png) | ![CWE-200-Response](./Screenshots/CWE-200/cwe-200-response.png) |
| CWE-284 | ![CWE-284-Request](./Screenshots/CWE-284/cwe-284-request.png) | ![CWE-284-Response](./Screenshots/CWE-284/cwe-284-response.png) |
| CWE-319 | ![CWE-319-Request](./Screenshots/CWE-319/cwe-319-request.png) | ![CWE-319-Response](./Screenshots/CWE-319/cwe-319-response.png) |
| CWE-798 | ![CWE-798-Request](./Screenshots/CWE-798/cwe-798-request.png) | ![CWE-798-Response](./Screenshots/CWE-798/cwe-798-response.png) |

## 3. Description

| CWE | Description |
|:---:|:-------------|
| CWE-23 | The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as ".." that can resolve to a location that is outside of that directory. |
| CWE-79 | The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users. |
| CWE-89 | The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. | 
| CWE-200 | The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information. |
| CWE-284 | The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor. |
| CWE-319 | The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors. | 
| CWE-798 | The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data. |

## 4. Recommendation

| CWE | Recommendation |
|:---:|:---------------|
| CWE-23 | Rigorously validate user input, use secure settings, and properly drop special characters to avoid malicious code injection. |
| CWE-79 | Properly validate and escape all dynamic data before displaying it on a web page to prevent malicious script injection. |
| CWE-89 | Use parameterized queries or secure Object-Relational Mapping (ORM)[^2] to interact with the database to avoid malicious SQL injection. |
| CWE-200 | Ensure that you are not inappropriately exposing sensitive information such as usernames, passwords, API keys or personal data in logs, error messages, HTTP responses or any other communication channels. communication. Implement appropriate masking or encryption mechanisms to protect this information from unauthorized access. |
| CWE-284 | Make sure you have appropriate access controls in place to restrict access to sensitive resources based on user privileges and roles. Use robust authentication and authorization mechanisms to ensure that only authorized users can access sensitive features or data. |
| CWE-319 | Always use secure communication protocols such as HTTPS instead of HTTP to transmit sensitive information to encrypt data and prevent unauthorized interception. |
| CWE-798 | Avoid including login credentials or authentication information directly in the source code. Instead, use secure mechanisms like secret managers or protected external configuration files to store and retrieve this information securely. |

---
## 5. Sources

- [Common Weakness Enumeration](https://cwe.mitre.org/index.html)

---

By Priscille and Loan.

---
[^1]: Vulnerability added but not requested.
[^2]: Is a programming technique for converting data between a relational database and the heap of an object-oriented programming language.
